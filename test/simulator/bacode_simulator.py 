import time
import json
import paho.mqtt.client as mqtt

MQTT_HOST = "localhost"
MQTT_PORT = 1883
TOPIC = "v1/conv/bc/scan"

client = mqtt.Client()

client.connect(MQTT_HOST, MQTT_PORT)
client.loop_start()

def simulate_barcode_scan():
    fake_data = {
        "id": "0123",           # ì œí’ˆ ID
        "comp": "99",           # ì œì¡°ì‚¬ ì½”ë“œ
        "exp": "250803",        # ìœ í†µê¸°í•œ YYMMDD
        "ts": int(time.time())  # íƒ€ì„ìŠ¤íƒ¬í”„
    }
    payload = json.dumps(fake_data)
    client.publish(TOPIC, payload, qos=1)
    print(f"ğŸ“¤ ë°”ì½”ë“œ ì „ì†¡ë¨ â†’ {payload}")

if __name__ == "__main__":
    while True:
        simulate_barcode_scan()
        time.sleep(10)  # 5ì´ˆë§ˆë‹¤ ë°”ì½”ë“œ 1ê±´ì”© ì „ì†¡
